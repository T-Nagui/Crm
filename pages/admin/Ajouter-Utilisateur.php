<?php /** *   * User: NAGUI * Date: 10/11/2015 * Time: 14:43 */ /*Fonction Test de role*//*if(!getinfo($_SESSION['user']['id'],'roles','GestUser')){$_SESSION['msg']="Vous n'avez pas des droit pour visualiser cette page";        $_SESSION['type']="alert-danger";      redirect(WEBRoot);}*//*End Fonction Test de role*/    /* Inscription File */     $Pos = filter_input(INPUT_POST, 'AddBtn');    $algo = "PASSWORD_BCRYPT";   $options = [    'cost' => 12,];     // echo  $verified = password_verify($pass, $hash)        ? 'The hash matches the entered password'        : 'The hash does not match the entered password';    if (isset($Pos) && $Pos == 1) {        //echo password_hash("rasmuslerdorf", PASSWORD_BCRYPT)."\n";        $Civilite = filter_input(INPUT_POST, 'Civilite');        $Nom = filter_input(INPUT_POST, 'Nom', FILTER_SANITIZE_STRING);        $Prenom = filter_input(INPUT_POST, 'prenom', FILTER_SANITIZE_STRING);        $Email = filter_input(INPUT_POST, 'Email', FILTER_VALIDATE_EMAIL);       $Psswd = filter_input(INPUT_POST, 'mdp', FILTER_SANITIZE_STRING);         $Tel = filter_input(INPUT_POST, 'Tel');        $datas = array(            'id' => '',            'Civilite' => $Civilite,            'Nom' => $Nom,            'type'=>filter_input(INPUT_POST, 'user_type',FILTER_VALIDATE_INT),              'login'=>filter_input(INPUT_POST, 'login'),            'Prenom' => $Prenom,            'Email' => $Email,             'password' => password_hash($Psswd,PASSWORD_BCRYPT, $options),            'Tel' => $Tel,             'active' => 1,             'SysDate' => date("Y-m-d H:i:s")        );         $user_id=add($datas, 'users');     if ($user_id) {         // ajouter ces role         $dataRole=  array(           'id'=>'',             'user_id'=>$user_id,             'GestUser'=>  filter_input(INPUT_POST,'GestUser',FILTER_VALIDATE_INT) ,              'vueDM'=>  filter_input(INPUT_POST,'vueDM',FILTER_VALIDATE_INT) ,              'vuePros'=>  filter_input(INPUT_POST,'vuePros',FILTER_VALIDATE_INT) ,              'SupPros'=>  filter_input(INPUT_POST,'SupPros',FILTER_VALIDATE_INT) ,              'ModPros'=>  filter_input(INPUT_POST,'ModPros',FILTER_VALIDATE_INT) ,              'Moddemande'=>  filter_input(INPUT_POST,'Moddemande',FILTER_VALIDATE_INT) ,              'ModVisite'=>  filter_input(INPUT_POST,'ModVisite',FILTER_VALIDATE_INT) ,              'cree_par'=>$_SESSION['user']['id'],             'modifier_par'=>'',             'created_at'=>date("Y-m-d H:i:s")                      );         add($dataRole,'roles');                      $_SESSION['msg'] = "Délégué ajouter avec success";              $_SESSION['type'] ="alert-success";              redirect('liste');        } else        {  $_SESSION['msg']="Une Erreur c'est produite";        $_SESSION['type']="alert-danger";        redirect('liste');        }             }    ?><section class="content-header">    <h1> Ajouter un Utilisateur        <small></small>    </h1>    <ol class="breadcrumb hidden">        <li><a href="#"><i class="fa fa-dashboard"></i> Level</a></li>        <li class="active">Here</li>    </ol></section><!-- Main content --><section class="content">       <div class="row">   <form role="form" method="post" class="">        <div class="col-md-4">            <div class="box box-primary">                <div class="box-header with-border"><h3 class="box-title">Ajouter information personnels</h3></div>                <!-- /.box-header -->                <!-- form start -->                 <input type="hidden" class="form-control" id="" name="type" value="3" placeholder="le nom du délégué">                    <div class="box-body">                        <div class="form-group"><label for="civi">Civilité</label>                            <select name="Civilite"  class="form-control"  id="civi">                                <option value="M">M</option>                                <option value="Mme">Mme</option>                                <option value="Mlle">Mlle</option>                            </select></div>                        <div class="form-group">                            <label for="name">Nom</label>             <input type="text" class="form-control"    id="name" name="Nom" placeholder="le nom du délégué">                        </div>                        <div class="form-group">                            <label for="lastname">Prénom</label>     <input type="text"  class="form-control" id="lastname" name="prenom" placeholder="le prénom du délégué">                        </div>                        <div class="form-group">                            <label for="login">Login</label>                            <input type="text" class="form-control" id="login" name="login" placeholder="Unique login">                        </div>                        <div class="form-group">                            <label for="exampleInputEmail1">Email address</label>                            <input type="email" class="form-control" id="exampleInputEmail1" placeholder="Enter email" name="Email">                        </div>                        <div class="form-group">                            <label for="exampleInputPassword1">Mot de passe</label>                            <input type="password" class="form-control" id="exampleInputPassword1" name="mdp" placeholder="Password">                        </div>                        <div class="form-group">                            <label for="telid">Tel.</label>                            <input type="text" class="form-control"  id="telid" name="tel" placeholder="Tel"></div>                    </div><!-- /.box-body -->                                             </div>        </div>        <div class="col-sm-8 col-md-8">            <div class="box"><div class="box-header with-border"><h3 class="box-title">Prévilège</h3></div><div class="box-body">    <div class="form-group">        <label>Type d'utilisateur</label>        <select name="user_type" class="form-control" required>            <option value="">Choix</option>            <? $Types=get("*",'user_type'); foreach ($Types['reponse'] as $USer):            ?>              <option value="<?=$USer['id']?>"><?=$USer['name']?></option>            <?  endforeach;?>        </select>    </div>    <div class="form-group">        <label class="fixed-width-label">           Gestion des utilisateurs </label>            <input type="checkbox" name="GestUser" value="1" class="previlege" checked>     </div>    <div class="form-group">        <label class="fixed-width-label">            Voir Liste des délégués </label>            <input type="checkbox" name="vueDM" value="1" class="previlege" checked>     </div>    <div class="form-group">        <label class="fixed-width-label">            Voir Liste des prospects </label>              <input type="checkbox" name="vuePros" value="1" class="previlege" checked>            </div>    <div class="form-group">        <label class="fixed-width-label">            Supprimer les prospects </label>              <input type="checkbox" name="SupPros" value="1" class="previlege">           </div>    <div class="form-group">        <label class="fixed-width-label">            Modifier les prospects </label>              <input type="checkbox" name="ModPros" value="1" class="previlege">            </div>    <div class="form-group">        <label class="fixed-width-label">            Modifier ces demande </label>              <input type="checkbox" name="Moddemande" value="1" class="previlege">            </div>    <div class="form-group">        <label class="fixed-width-label">            Modifier ces visite </label>              <input type="checkbox" name="ModVisite" value="1" class="previlege">            </div></div><div class="box-footer">                        <button type="submit" class="btn btn-primary" name="AddBtn" value="1">Ajouter</button>                    </div>            </div>        </div>   </form>            </div></section><!-- /.content -->